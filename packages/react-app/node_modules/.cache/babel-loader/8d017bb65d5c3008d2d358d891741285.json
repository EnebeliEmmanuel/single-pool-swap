{"ast":null,"code":"import _regeneratorRuntime from\"/home/kokocodes/single-pool-dex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/kokocodes/single-pool-dex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/kokocodes/single-pool-dex/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{ethers}from\"ethers\";import React,{useState,useEffect}from\"react\";import PoolFormRow from\"./PoolFormRow\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var contractName=\"DEX\";var tokenName=\"Balloons\";export default function PoolTab(props){var tx=props.tx;var writeContracts=props.writeContracts;var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),liquidityAmount=_useState2[0],setLiquidityAmount=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),addingLiquidity=_useState4[0],setAddingLiquidity=_useState4[1];var _useState5=useState(true),_useState6=_slicedToArray(_useState5,2),addressApproved=_useState6[0],setAddressApproved=_useState6[1];var changeAddLiquidity=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(value){var valuePlusExtra,allowance;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:valuePlusExtra=ethers.utils.parseEther(\"\"+value*1.03);_context.next=3;return props.readContracts[tokenName].allowance(props.address,props.readContracts[contractName].address);case 3:allowance=_context.sent;setLiquidityAmount(value);setAddingLiquidity(true);if(allowance.lt(valuePlusExtra)){setAddressApproved(false);}else{setAddressApproved(true);}case 7:case\"end\":return _context.stop();}}},_callee);}));return function changeAddLiquidity(_x){return _ref.apply(this,arguments);};}();var changeWithdrawLiquidity=function changeWithdrawLiquidity(value){setLiquidityAmount(value);setAddingLiquidity(false);};var depositLiquidity=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(value){var valueInEther;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log(\"Depositing \".concat(liquidityAmount,\" of liquidity\"));valueInEther=ethers.utils.parseEther(\"\"+value);_context2.next=4;return tx(writeContracts[contractName][\"deposit\"]({value:valueInEther,gasLimit:200000}));case 4:setLiquidityAmount(\"\");case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function depositLiquidity(_x2){return _ref2.apply(this,arguments);};}();var withdrawLiquidity=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(value){var valueInEther,withdrawTxResult;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log(\"Withdrawing \".concat(liquidityAmount,\" of liquidity\"));valueInEther=ethers.utils.parseEther(\"\"+value);_context3.next=4;return tx(writeContracts[contractName][\"withdraw\"](valueInEther));case 4:withdrawTxResult=_context3.sent;console.log(\"withdrawTxResult:\",withdrawTxResult);setLiquidityAmount(\"\");case 7:case\"end\":return _context3.stop();}}},_callee3);}));return function withdrawLiquidity(_x3){return _ref3.apply(this,arguments);};}();var approveDeposit=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(value){var valuePlusExtra;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log(\"Approving \".concat(liquidityAmount,\" to be spent\"));valuePlusExtra=ethers.utils.parseEther(\"\"+value*1.03);_context4.next=4;return tx(writeContracts[tokenName].approve(props.readContracts[contractName].address,valuePlusExtra,{gasLimit:200000}));case 4:setAddressApproved(true);case 5:case\"end\":return _context4.stop();}}},_callee4);}));return function approveDeposit(_x4){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/_jsx(\"div\",{className:\"simple-ui-card\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"form-heading\",children:\" Add Liquidity\"}),/*#__PURE__*/_jsx(PoolFormRow,{changeValueFunction:changeAddLiquidity,value:addingLiquidity==true?liquidityAmount:\"\",approvalNeeded:!addressApproved,executeFunction:depositLiquidity,approvalFunction:approveDeposit,buttonLabel:\"Deposit\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-heading\",children:\" Withdraw Liquidity\"}),/*#__PURE__*/_jsx(PoolFormRow,{changeValueFunction:changeWithdrawLiquidity,value:addingLiquidity==false?liquidityAmount:\"\",approvalNeeded:false,executeFunction:withdrawLiquidity,buttonLabel:\"Withdraw\"})]})});};","map":{"version":3,"sources":["/home/kokocodes/single-pool-dex/packages/react-app/src/components/PoolTab.jsx"],"names":["ethers","React","useState","useEffect","PoolFormRow","contractName","tokenName","PoolTab","props","tx","writeContracts","liquidityAmount","setLiquidityAmount","addingLiquidity","setAddingLiquidity","addressApproved","setAddressApproved","changeAddLiquidity","value","valuePlusExtra","utils","parseEther","readContracts","allowance","address","lt","changeWithdrawLiquidity","depositLiquidity","console","log","valueInEther","gasLimit","withdrawLiquidity","withdrawTxResult","approveDeposit","approve"],"mappings":"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","sourcesContent":["import { ethers } from \"ethers\";\nimport React, { useState, useEffect } from \"react\";\nimport PoolFormRow from \"./PoolFormRow\";\n\nconst contractName = \"DEX\";\nconst tokenName = \"Balloons\";\n\nexport default function PoolTab(props) {\n\n  const tx = props.tx;\n  const writeContracts = props.writeContracts;\n\n\n  const [liquidityAmount, setLiquidityAmount] = useState(\"\");\n  const [addingLiquidity, setAddingLiquidity] = useState(true);\n  const [addressApproved, setAddressApproved] = useState(true);\n\n  \n\n  const changeAddLiquidity = async value => {\n\n    let valuePlusExtra = ethers.utils.parseEther(\"\" + value * 1.03);\n\n  let allowance = await props.readContracts[tokenName].allowance(\n   props.address,\n       props.readContracts[contractName].address,\n    );\n    setLiquidityAmount(value);\n    setAddingLiquidity(true);\n    if (allowance.lt(valuePlusExtra)) {\n      setAddressApproved(false);\n    } else {\n      setAddressApproved(true);\n    }\n  }\n\n  const changeWithdrawLiquidity = value => {\n      setLiquidityAmount(value);\n      setAddingLiquidity(false);\n   \n      }\n\n  const depositLiquidity = async (value) => {\n   console.log(`Depositing ${liquidityAmount} of liquidity`)\n\n     let valueInEther = ethers.utils.parseEther(\"\" + value);\n \n    await tx(writeContracts[contractName][\"deposit\"]({ value: valueInEther, gasLimit: 200000 }));\n    setLiquidityAmount(\"\");\n    }\n\n \n  \n  const withdrawLiquidity = async (value) => {\n     console.log(`Withdrawing ${liquidityAmount} of liquidity`)\n\n  \n    let valueInEther = ethers.utils.parseEther(\"\" + value);\n     let withdrawTxResult = await tx(writeContracts[contractName][\"withdraw\"](valueInEther));\n     console.log(\"withdrawTxResult:\", withdrawTxResult);\n     setLiquidityAmount(\"\");\n\n  }\n  const approveDeposit = async (value) => {\n\n\n    \n    console.log(`Approving ${liquidityAmount} to be spent`)\n\n    let valuePlusExtra = ethers.utils.parseEther(\"\" + value * 1.03);\n  \n \n   \n     await tx(\n        writeContracts[tokenName].approve(props.readContracts[contractName].address, valuePlusExtra, {\n        gasLimit: 200000,\n        }),\n     );\n     \n\n    setAddressApproved(true);\n  }\n\n  return (\n    <div className=\"simple-ui-card\">\n      \n      <div className=\"form-group\">\n        <div className=\"form-heading\"> Add Liquidity</div>\n        <PoolFormRow\n          changeValueFunction={changeAddLiquidity}\n          value={addingLiquidity == true ? liquidityAmount : \"\"}\n          approvalNeeded={!addressApproved}\n          executeFunction={depositLiquidity}\n          approvalFunction={approveDeposit}\n          buttonLabel={\"Deposit\"}\n        />\n       \n        <div className=\"form-heading\"> Withdraw Liquidity</div>\n\n        <PoolFormRow\n          changeValueFunction={changeWithdrawLiquidity}\n          value={addingLiquidity == false ? liquidityAmount : \"\"}\n          approvalNeeded={false}\n          executeFunction={withdrawLiquidity}\n          buttonLabel={\"Withdraw\"}\n        />\n\n      </div>\n    </div>\n  );\n};\n\n"]},"metadata":{},"sourceType":"module"}